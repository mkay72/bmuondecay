! This file is a part of the program hfd
! for details, see Refs.
!
! [1] V. F. Bratzev, G. B. Deyneka, and I. I. Tupitsyn, 
!     Bull. Acad. Sci. USSR, Phys. Ser. 41, 173 (1977) 
!     [Izv. Acad. Nauk SSSR, Ser. Fiz. 41, 2655 (1977)].
!
! [2] I. I. Tupitsyn, V. M. Shabaev, 
!     J. R. Crespo López-Urrutia, I. Draganić, 
!     R. S. Orts, and J. Ullrich, Phys. Rev. A 68, 022511 (2003).
!
! [3] I. I. Tupitsyn, A. V. Volotka, D. A. Glazov, 
!     V. M. Shabaev, G. Plunien, J. R. Crespo López-Urrutia, 
!     A. Lapierre, and J. Ullrich, Phys. Rev. A 72, 062503 (2005).
!
! [4] I. I. Tupitsyn, N. A. Zubova, V. M. Shabaev, 
!     G. Plunien, and T. Stöhlker, Phys. Rev. A 98, 022517 (2018).
!
        subroutine hfd_cgc(j1, m1, j2, m2, j3, m3, res)
!       - - - - - - - - - - - - - - - - - - - - - - - - -
        implicit real(8) (a-h,o-z)
!       - - - - - - - - - - - - - - - - - - - - - - - - -
        real(8)  j1,m1,j2,m2,j3,m3
        real(8)  res
        integer :: ic
        
!       table of Log(Gamma(i+1)) i = 0..150       
        real(8), parameter :: fac(150)= &
        (/                              &
              0.0000000000000000d0,     &
              0.0000000000000000d0,     &
              0.6931471805599453d0,     &
              1.7917594692280550d0,     &
              3.1780538303479456d0,     &
              4.7874917427820460d0,     &
              6.5792512120101010d0,     &
              8.5251613610654143d0,     &
              10.604602902745250d0,     &
              12.801827480081470d0,     &
              15.104412573075515d0,     &
              17.502307845873886d0,     &
              19.987214495661886d0,     &
              22.552163853123423d0,     &
              25.191221182738682d0,     &
              27.899271383840892d0,     &
              30.671860106080673d0,     &
              33.505073450136889d0,     &
              36.395445208033054d0,     &
              39.339884187199494d0,     &
              42.335616460753485d0,     &
              45.380138898476908d0,     &
              48.471181351835224d0,     &
              51.606675567764374d0,     &
              54.784729398112319d0,     &
              58.003605222980520d0,     &
              61.261701761002002d0,     &
              64.557538627006331d0,     &
              67.889743137181535d0,     &
              71.257038967168009d0,     &
              74.658236348830164d0,     &
              78.092223553315311d0,     &
              81.557959456115037d0,     &
              85.054467017581517d0,     &
              88.580827542197679d0,     &
              92.136175603687092d0,     &
              95.719694542143202d0,     &
              99.330612454787427d0,     &
              102.96819861451381d0,     &
              106.63176026064346d0,     &
              110.32063971475740d0,     &
              114.03421178146170d0,     &
              117.77188139974507d0,     &
              121.53308151543863d0,     &
              125.31727114935690d0,     &
              129.12393363912721d0,     &
              132.95257503561631d0,     &
              136.80272263732637d0,     &
              140.67392364823426d0,     &
              144.56574394634489d0,     &
              148.47776695177303d0,     &
              152.40959258449736d0,     &
              156.36083630307879d0,     &
              160.33112821663091d0,     &
              164.32011226319518d0,     &
              168.32744544842765d0,     &
              172.35279713916280d0,     &
              176.39584840699735d0,     &
              180.45629141754377d0,     &
              184.53382886144949d0,     &
              188.62817342367159d0,     &
              192.73904728784490d0,     &
              196.86618167288999d0,     &
              201.00931639928153d0,     &
              205.16819948264120d0,     &
              209.34258675253684d0,     &
              213.53224149456326d0,     &
              217.73693411395423d0,     &
              221.95644181913033d0,     &
              226.19054832372759d0,     &
              230.43904356577695d0,     &
              234.70172344281827d0,     &
              238.97838956183432d0,     &
              243.26884900298271d0,     &
              247.57291409618688d0,     &
              251.89040220972319d0,     &
              256.22113555000953d0,     &
              260.56494097186321d0,     &
              264.92164979855280d0,     &
              269.29109765101982d0,     &
              273.67312428569370d0,     &
              278.06757344036614d0,     &
              282.47429268763040d0,     &
              286.89313329542699d0,     &
              291.32395009427031d0,     &
              295.76660135076062d0,     &
              300.22094864701413d0,     &
              304.68685676566872d0,     &
              309.16419358014692d0,     &
              313.65282994987906d0,     &
              318.15263962020933d0,     &
              322.66349912672618d0,     &
              327.18528770377522d0,     &
              331.71788719692847d0,     &
              336.26118197919848d0,     &
              340.81505887079902d0,     &
              345.37940706226685d0,     &
              349.95411804077024d0,     &
              354.53908551944081d0,     &
              359.13420536957540d0,     &
              363.73937555556349d0,     &
              368.35449607240475d0,     &
              372.97946888568902d0,     &
              377.61419787391866d0,     &
              382.25858877306003d0,     &
              386.91254912321755d0,     &
              391.57598821732962d0,     &
              396.24881705179153d0,     &
              400.93094827891575d0,     &
              405.62229616114489d0,     &
              410.32277652693731d0,     &
              415.03230672824964d0,     &
              419.75080559954473d0,     &
              424.47819341825707d0,     &
              429.21439186665157d0,     &
              433.95932399501482d0,     &
              438.71291418612118d0,     &
              443.47508812091894d0,     &
              448.24577274538461d0,     &
              453.02489623849614d0,     &
              457.81238798127818d0,     &
              462.60817852687492d0,     &
              467.41219957160818d0,     &
              472.22438392698060d0,     &
              477.04466549258563d0,     &
              481.87297922988793d0,     &
              486.70926113683941d0,     &
              491.55344822329800d0,     &
              496.40547848721762d0,     &
              501.26529089157929d0,     &
              506.13282534203488d0,     &
              511.00802266523603d0,     &
              515.89082458782240d0,     &
              520.78117371604415d0,     &
              525.67901351599506d0,     &
              530.58428829443349d0,     &
              535.49694318016954d0,     &
              540.41692410599767d0,     &
              545.34417779115487d0,     &
              550.27865172428557d0,     &
              555.22029414689487d0,     &
              560.16905403727304d0,     &
              565.12488109487430d0,     &
              570.08772572513421d0,     &
              575.05753902471021d0,     &
              580.03427276713078d0,     &
              585.01787938883912d0,     &
              590.00831197561785d0,     &
              595.00552424938197d0,     &
              600.00947055532743d0     /)
!       - - - - - - - - - - - - - - - - - - - - - - - - -
        ic=0
        r=0.d0
        c1=0.01d0
        eps=1.d-8
        
        mm1=m1+m1+dsign(c1,m1)
        mm2=m2+m2+dsign(c1,m2)
        mm3=m3+m3+dsign(c1,m3)
        
        if (mm1+mm2.ne.mm3) goto 1000
        jj1=j1+j1+c1
        jj2=j2+j2+c1
        jj3=j3+j3+c1
        
        if (jj1.lt.iabs(mm1)) goto 1000
        if (jj2.lt.iabs(mm2)) goto 1000
        if (jj3.lt.iabs(mm3)) goto 1000
        if (jj3.lt.iabs(jj1-jj2)) goto 1000
        if (jj3.gt.    (jj1+jj2)) goto 1000
        s=j1+j2+j3
        l=s+c1
        
        if (dabs(s-l ).gt.eps) goto 1000
        s=j1+m1
        l1=s+c1
        if (dabs(s-l1).gt.eps) goto 1000
        s=j2+m2
        l2=s+c1
        if (dabs(s-l2).gt.eps) goto 1000
        s=j3+m3
        l3=s+c1
        if (dabs(s-l3).gt.eps) goto 1000
        ic=1
        if (jj2.ne.0) goto 200
        r=1.d0
        goto 1000
        
        
200     k=(jj1+jj2+jj3)/2+2
        
        if (k.gt.150) goto 777
        l=(jj1+jj2-jj3)/2
        q=dlog(jj3+1.d0)
        q=q-fac(k)
        k=l+1
        q=q+fac(k)
        k=(jj1+jj3-jj2)/2+1
        q=q+fac(k)
        k=(jj2+jj3-jj1)/2+1
        q=q+fac(k)
        k=l1+1
        q=q+fac(k)
        l1=(jj1-mm1)/2
        k=l1+1
        q=q+fac(k)
        k=l2+1
        q=q+fac(k)
        k=(jj2-mm2)/2+1
        q=q+fac(k)
        k=l3+1
        q=q+fac(k)
        k=(jj3-mm3)/2+1
        q=q+fac(k)
        q=q*0.5d0
        i1=0
        l3=(jj3-jj2+mm1)/2
        if (l3.lt.0) i1=-l3
        l4=(jj3-jj1-mm2)/2
        if (i1+l4.lt.0) i1=-l4
        i2=l
        if (l2.lt.i2) i2=l2
        if (l1.lt.i2) i2=l1
        s=1.d0
        if (i1.ne.2*(i1/2)) s=-1.d0
        i1=i1+1
        i2=i2+1
        do 10 i=i1,i2
        k=i
        p=q-fac(k)
        k=l -i+2
        p=p-fac(k)
        k=l1-i+2
        p=p-fac(k)
        k=l2-i+2
        p=p-fac(k)
        k=l3+i
        p=p-fac(k)
        k=l4+i
        p=p-fac(k)
        r=r+dsign(dexp(p),s)
        s=-s
10      continue
1000    res=r
!       - - - - - - - - - - - - - - - - - - - - - - - - -
        return
777     write (7,75) k
75      format (4x,'fac.ge.150!  k=',i3)
        end
